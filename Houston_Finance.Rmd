---
title: "Houston_Finance"
output: html_document
date: "2024-06-03"
---

Question: Who is funding local Houston political candidates?

installing basic packages if needed

```{r}

```

## R Markdown

loading in necessary packages
```{r}
library(tidyverse)
library(rio)
library(janitor)
library(dplyr)
library(openxlsx)
```

reading in the data

```{r}
Campaign_data <- read_csv("campaign_finance.csv")
```


looking at summary of data
```{r}
head(Campaign_data)
```
now I filtered for current incumbents that appeared on the campaign spreadsheet, creating a new spreadsheet for each individuals table

Some of the names had multiple formats, so I have some variables listing their different formats

```{r}
Sallie_Alcorn <- Campaign_data %>% filter(CandidateFullName %in% "Sallie Alcorn")
Willie_R_Davis <- Campaign_data %>% filter(CandidateFullName == "Willie R Davis")
Martha_Castex_Tatum <- Campaign_data %>% filter(CandidateFullName == "Martha Castex-Tatum")
Mr_Edward_J_Pollard <- Campaign_data %>% filter(CandidateFullName == "Mr. Edward J Pollard")
Adrian_Garcia <- Campaign_data %>% filter(CandidateFullName == "Adrian Garcia")
Dr_Carolyn_Evans_Shabazz <- Campaign_data %>% filter(CandidateFullName == "Dr. Carolyn Evans-Shabazz")
amy_peck_variants <- c("Ms. Amy Peck", "Ms. Amy L Peck", "Mrs. Amy Peck")
Amy_Peck <- Campaign_data %>% filter(CandidateFullName %in% amy_peck_variants)
edward_gonzalez_variants <- c("Mr. Edward Ed Gonzalez", "Edward Edward Gonzalez", "Edward Ed Gonzalez")
Edward_Gonzalez <- Campaign_data %>% filter(CandidateFullName %in% edward_gonzalez_variants)

```


sort the data by donation amount, I also had to change the column type from character to int:

```{r}
# Amy_Peck
Amy_Peck$TransactionAmount <- as.numeric(Amy_Peck$TransactionAmount)
Amy_Peck <- Amy_Peck %>% arrange(desc(TransactionAmount))

# Willie_R_Davis
Willie_R_Davis$TransactionAmount <- as.numeric(Willie_R_Davis$TransactionAmount)
Willie_R_Davis <- Willie_R_Davis %>% arrange(desc(TransactionAmount))

# Martha_Castex_Tatum
Martha_Castex_Tatum$TransactionAmount <- as.numeric(Martha_Castex_Tatum$TransactionAmount)
Martha_Castex_Tatum <- Martha_Castex_Tatum %>% arrange(desc(TransactionAmount))

# Mr_Edward_J_Pollard
Mr_Edward_J_Pollard$TransactionAmount <- as.numeric(Mr_Edward_J_Pollard$TransactionAmount)
Mr_Edward_J_Pollard <- Mr_Edward_J_Pollard %>% arrange(desc(TransactionAmount))

# Adrian_Garcia
Adrian_Garcia$TransactionAmount <- as.numeric(Adrian_Garcia$TransactionAmount)
Adrian_Garcia <- Adrian_Garcia %>% arrange(desc(TransactionAmount))

# Dr_Carolyn_Evans_Shabazz
Dr_Carolyn_Evans_Shabazz$TransactionAmount <- as.numeric(Dr_Carolyn_Evans_Shabazz$TransactionAmount)
Dr_Carolyn_Evans_Shabazz <- Dr_Carolyn_Evans_Shabazz %>% arrange(desc(TransactionAmount))

# Edward_Gonzalez
Edward_Gonzalez$TransactionAmount <- as.numeric(Edward_Gonzalez$TransactionAmount)
Edward_Gonzalez <- Edward_Gonzalez %>% arrange(desc(TransactionAmount))

# Sallie_Alcorn
Sallie_Alcorn$TransactionAmount <- as.numeric(Sallie_Alcorn$TransactionAmount)
Sallie_Alcorn <- Sallie_Alcorn %>% arrange(desc(TransactionAmount))
```


Check that the candidate spreadsheet was properly sorted based on the transaction amount


```{r}
result <- Sallie_Alcorn %>% 
  select(CampaignYear, TransactionAmount, TransactionPartyFullName, TransactionPartyEmployer, OfficeSought, TransactionAddressStreet, TransactionPartyCity, TransactionPartyOccupation) %>% 
  group_by(TransactionAmount)
write.xlsx(result, file = "Sallie_Alcorn_Transactions.xlsx")
```

End product: Each of the incumbent candidates has their own spreadsheet of donors, sorted by the transaction amount from highest to lowest


Pick out location map based on current incumbents:
```{r}
incumbent_data <-  read_csv("incumbent_transactions.csv")


```
```{r}
incumbent_map <- incumbent_data %>% 
  select(CandidateFullName, CampaignYear, TransactionAmount, TransactionPartyFullName, TransactionPartyEmployer, TransactionAddressStreet, TransactionPartyCity, TransactionPartyState, TransactionPartyOccupation, OfficeSought, TransactionType, MasterTransactionType) %>% 
  group_by(TransactionAmount)
incumbent_map <- incumbent_map %>% arrange(desc(TransactionAmount))

write.csv(incumbent_map, file = "incumbent_map_data.csv")

```
now pull out the incumbents contributions only, not their political expenditures



```{r}
contributions_variants <- c("Political Contributions Other Than Pledges or Loans", "Political Contributions")

only_contributions <- incumbent_map %>% filter(MasterTransactionType %in% contributions_variants)
write.csv(only_contributions, file = "only_contributions.csv")

```


```{r}
only_contributions <-  read_csv("only_contributions.csv")
# Sum values by name using dplyr
```
```{r}
colnames(only_contributions)
```

```{r}
sum_by_city <- only_contributions %>%
  filter(!is.na(TransactionAmount)) %>%
  group_by(TransactionPartyCity) %>%
  summarize(total = sum(TransactionAmount))

# View result
write.csv(sum_by_city, file = "sum_by_city.csv")

```
now need to compare in state contributions and out of state contributions 
